<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <title>Bài cào</title>
    <link rel="icon" href="../media/favicon.ico">
    <meta name="author" content="ThienFakeVN">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {font-family: 'Consolas', "courier new"; padding: 20px;}
        .result {margin-top: 20px;}
        .player {margin: 8px 0;}
        input {padding: 5px;}
        button {padding: 6px 12px; margin-left: 10px; cursor: pointer;}
    </style>
</head>
<body>
    <h1>Bài cào</h1>
    <p>The rule's simple: The one with the highest points wins, but the rule isn't just counting points...</p>
    <label for="players">Enter the amount of players: </label>
    <input type="number" id="players" placeholder="Amount of players" min="1" max="17">
    <button onclick="play()">DEAL!</button>

    <div class="result" id="result"></div>

    <script> // With the help from ChatGPT!! Original Python file's here: bài_cào.py
        function play() {
            let players = parseInt(document.getElementById("players").value)
            const resultDiv = document.getElementById("result")
            resultDiv.innerHTML = ""

            if (isNaN(players) || players <= 0) {
                resultDiv.innerHTML = "⚠️ The amount of players must be greater than 0!"
                return
            }
            if (players > 17) {
                resultDiv.innerHTML = "⚠️ Too many players! At most 17!"
                return
            }

            let pack = [
                "A♠","2♠","3♠","4♠","5♠","6♠","7♠","8♠","9♠","10♠","J♠","Q♠","K♠",
                "A♣","2♣","3♣","4♣","5♣","6♣","7♣","8♣","9♣","10♣","J♣","Q♣","K♣",
                "A♦","2♦","3♦","4♦","5♦","6♦","7♦","8♦","9♦","10♦","J♦","Q♦","K♦",
                "A♥","2♥","3♥","4♥","5♥","6♥","7♥","8♥","9♥","10♥","J♥","Q♥","K♥",
            ]

            for (let i = pack.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1))
                [pack[i], pack[j]] = [pack[j], pack[i]]
            }

            let results = []

            for (let i = 0; i < players; i++) {
                let hand = [pack.pop(), pack.pop(), pack.pop()]
                let ranks = hand.map(c => c.slice(0, -1))

                let points
                if (ranks.every(r => ["J","Q","K"].includes(r))) {points = "Ba cào!!!"}
                else {
                    let values = ranks.map(r => {
                        if (["J","Q","K"].includes(r)) return 10
                        if (r === "A") return 1
                        return parseInt(r)
                    })
                    points = values.reduce((a,b) => a+b, 0) % 10
                }

                results.push(points)
                let p = document.createElement("div")
                p.className = "player"
                p.textContent = `Player ${i+1}: [${hand.join(", ")}] => ${points}`
                resultDiv.appendChild(p)
            }

            let final = document.createElement("div")
            final.innerHTML = "<strong>Results:</strong> " + results.join(", ")
            console.log(results)
            resultDiv.appendChild(final)
        }
    </script>
    <h1>Rules of Bài cào</h1>
        <p>Require: Standard 52-card pack (no jokers), at most 17 players.</p>
        <p>The dealer gives each player 3 cards, including themselves if they also play.</p>
        <p>When scoring, only the last digit of the sum of card points counts (A = 0; 2—10 = face value; J, Q, K = 10). E.g. [5♦, 4♠, A♥] = 10 => 0; [7♥, 8♣, K♥] = 25 => 5</p>
        <p>If all cards of a player are court cards, the player gets "Ba cào!!!" which is the highest possible hand, even higher than 9 points. E.g. [J♥, K♦, K♣] => Ba cào!!!</p>
        <p>If there's a draw, the players with highest hands will have another match until there's one player left.</p>
        <p>Suits don't matter, 3♠ equals to 3♦.</p>
</body>
</html>
